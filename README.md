# mlops_kulikekaterina_hw1

## Описание проекта
Сервис реализует батч-скоринг транзакций для задачи классификации мошенничества. Он принимает файл test.csv в директории ./input, выполняет обработку данных и прогнозирование предобученной моделью CatBoost, и сохраняет результаты в директорию ./output в формате sample_submission.csv.

Дополнительно к прогнозированию таргета выгружаются топ-5 признаков по важности и график распределения предсказанных вероятностей.

Модель model.cbm не хранится в репозитории напрямую, а автоматически загружается из GitHub Release при сборке Docker-образа.

## Архитектура решения

```bash
├── Dockerfile              
├── entrypoint.sh            
├── requirements.txt         
├── README.md
│
├── src/
│   ├── preprocessing.py     
│   ├── scorer.py            
│   └── export_outputs.py    
│
├── models/
│   ├── model.cbm             # Сериализованная модель (скачивается при сборке)
│   └── features.txt          
│
├── input/                  
└── output/                 
```

## Пайплайн обработки данных

1. preprocessing.py
	•	Загружает test.csv из ./input/;
	•	Приводит признаки к формату, ожидаемому моделью (feature engineering, one-hot, обработка пропусков);
	•	Сохраняет обработанные данные в промежуточный файл.

2. scorer.py
	•	Загружает модель model.cbm из ./models/;
	•	Вычисляет вероятности мошенничества;
	•	Сохраняет предсказания в формате sample_submission.csv.

3. export_outputs.py
	•	Строит распределение вероятностей;
	•	Извлекает feature importances и сохраняет их в JSON;
	•	Кладёт все результаты в директорию ./output/.

## Быстрый старт

### Требования

- Docker 20.10+
- 2 ГБ свободного места
- CPU-инференс, GPU не требуется

### Запуск сервиса

1. Скачайте файл test.csv из соревнования https://www.kaggle.com/competitions/teta-ml-1-2025 и разместите в директории ./input.
2. Соберите образ
```bash
docker build -t fraud_service .
```
4. Запустите контейнер с монтированием директорий
```bash
docker run -it --rm \
  -v ./input:/app/input \
  -v ./output:/app/output \
  fraud_service
```
5. После запуска контейнера сервис автоматически:
   
	•	загрузит входной файл test.csv из папки input;
	•	выполнит препроцессинг и скоринг данных;
	•	сохранит результат моделирования в директорию ./output.

Файлы, появляющиеся в output/:
